{
   "Version": "2012-10-17",
   "Statement": [
      {
         "Sid":"EnforceResourcePerimeterAWSResources",
         "Effect":"Deny",
         "Action":"*",
         "NotResource": [
            "arn:aws:iam::aws:policy/*",
            "arn:aws:ssm:*::document/*",
            "arn:aws:ssm:*::parameter/*",
            "arn:aws:ssm:*::automation-definition/*",
            "arn:aws:imagebuilder:*:aws:component/*",
            "arn:aws:imagebuilder:*:aws:image/*",
            "arn:aws:ec2:*::image/*",
            "arn:aws:ec2:*:aws:prefix-list/*",
            "arn:aws:lambda:*:<service-account-id>:layer:*",
            "arn:aws:ecr:*:<service-account-id>:repository/*",
            "arn:aws:s3:::aws-glue-studio-transforms-<service-account-id>-prod-<region>/*",
            "arn:aws:s3:::elasticbeanstalk-samples-<region>/*",
            "arn:aws:s3:::elasticbeanstalk-platform-assets-<region>/*", 
            "arn:aws:s3:::elasticbeanstalk-env-resources-<region>/*",
            "arn:aws:s3:::elasticbeanstalk-<region>/*",
            "arn:aws:s3:::jumpstart-cache-prod-<region>/*",
            "arn:aws:s3:::jumpstart-cache-prod-<region>",
            "arn:aws:cloudformation:*:aws:transform/*", 
            "arn:aws:s3:::aws-synthetics-library-<unique-identifier>/*", 
            "arn:aws:s3:::<unique-identifier>aws-data-exchange<unique-identifier>", 
            "arn:aws:s3:::sc-<product-identifier>-<region>/*", 
            "arn:aws:s3:::aws-neptune-notebook",
            "arn:aws:s3:::aws-neptune-notebook/*",
            "arn:aws:s3:::aws-neptune-notebook-<region>",
            "arn:aws:s3:::aws-neptune-notebook-<region>/*",
            "<third-party-resource>" 
         ],
         "Condition":{
            "StringNotEqualsIfExists":{
               "aws:ResourceOrgID":"<my-org-id>",
               "aws:PrincipalTag/dp:exclude:resource": "true"
            }
         }
      },
      {
         "Sid":"EnforceResourcePerimeterAWSResourcesS3",
         "Effect":"Deny",
         "Action":"*",
         "Resource":[
            "arn:aws:s3:::<unique-identifier>aws-data-exchange<unique-identifier>",
            "arn:aws:s3:::sc-<product-identifier>-<region>/*"
         ],
         "Condition":{
            "StringNotEqualsIfExists":{
               "aws:ResourceOrgID":"<my-org-id>",
               "aws:PrincipalTag/dp:exclude:resource": "true"
            },
            "ForAllValues:StringNotEquals":{
               "aws:CalledVia":[
                  "dataexchange.amazonaws.com",
                  "servicecatalog.amazonaws.com"
               ]
            }
         }
      },
      {
         "Sid":"EnforceResourcePerimeterThirdPartyResources",
         "Effect":"Deny",
         "Action":"*",
         "Resource":[
            "<third-party-resource>"
         ],
         "Condition":{
            "StringNotEqualsIfExists":{
               "aws:PrincipalTag/dp:exclude:resource": "true",
               "aws:ResourceAccount": [
                  "<third-party-account-a>",
                  "<third-party-account-b>"
               ]
            }
         }
      }
   ]
}