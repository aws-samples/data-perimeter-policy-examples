{
   "Version":"2012-10-17",
   "Statement":[
      {
         "Sid":"EnforceNetworkPerimeterOnLambdaRoles",
         "Effect":"Deny",
         "NotAction":[
            "es:ES*",
            "dax:GetItem",
            "dax:BatchGetItem",
            "dax:Query",
            "dax:Scan",
            "dax:PutItem",
            "dax:UpdateItem",
            "dax:DeleteItem",
            "dax:BatchWriteItem",
            "dax:ConditionCheckItem",
            "logs:CreateLogGroup",
            "logs:CreateLogStream",
            "logs:PutLogEvents",
            "elasticfilesystem:ClientMount",
            "xray:PutTraceSegments"
         ],
         "Resource":"*",
         "Condition":{
            "BoolIfExists":{
               "aws:ViaAWSService":"false"
            },
            "NotIpAddressIfExists":{
               "aws:SourceIp":[
                  "<my-corporate-cidr>"
               ]
            },
            "StringNotEqualsIfExists":{
               "aws:PrincipalTag/dp:exclude:network":"true",
               "aws:VpceOrgID":"<my-org-id>"
            },
            "Null":{
               "lambda:SourceFunctionArn":"false"
            }
         }
      }
   ]
}